- form_tag do
  = link_to "New Pool", new_pool_path, { :class => 'button' }
  = restful_submit_tag "Destroy", 'destroy', multi_destroy_pools_path, 'DELETE', :id => 'delete_button'
  %p
    Select:&nbsp;
    = link_to "All", @url_params.merge(:select => 'all')
    %span> ,&nbsp;
    = link_to "None", @url_params.merge(:select => 'none')
  %table#pools_table
    = sortable_table_header @header
    - @pools.each do |pool|
      %tr
        %td
          - selected = @url_params[:select] == 'all'
          %input{:name => "pools_selected[]", :type => "checkbox", :value => pool.id, :id => "pool_checkbox_#{pool.id}", :checked => selected }
          = link_to pool.name, pool_path(pool)
        %td
          = pool.quota.maximum_running_instances or 'unlimited'
        %td
          = pool.quota.percentage_used
          ='%'
        %td
          = pool.pool_family.name
        %td
          = pool.enabled

:javascript
  $(document).ready(function () {
    $('#delete_button').click(function(e) {
      if ($("#pools_table input[@type=radio]:checked").length == 0) {
        alert('Please select any pool to be deleted before clicking Delete button.');
        e.preventDefault();
      } else {
        if (!confirm("Are you sure you want to delete this pool?")) {
          e.preventDefault();
        }
      }
    });
  });
