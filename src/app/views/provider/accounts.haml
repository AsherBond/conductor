:javascript
  function set_unlimited_quota(elem_id) {
    $("#" + elem_id)[0].value = "unlimited";
  }
= render :partial => 'providers'
#details.grid_13
  %nav.subsubnav
    = render_navigation(:level => 4)

  %h1
    = t('.provider_accounts')
  - form_tag({:controller => 'cloud_accounts', :action => 'update_accounts'}, :multipart => true) do
    %fieldset.clearfix.nomargin
      %label.grid_2.la.alpha
        = t('.account_name')
        %span.required *
      %label.grid_2.la
        = t('.user_name')
        %span.required *
      %label.grid_2.la
        = t('.password')
        %span.required *
      %label.grid_1.la
        = t('.quota_instances')
        %span.required *
      %label.grid_1.la
        = t('.account_number')
        %span.required *
      %label.grid_2.la
        = t('.account_private_cert')
        %span.required *
      %label.grid_2.la
        = t('.account_public_cert')
        %span.required *
      .grid_1.omega

    = hidden_field :provider, :id, :value => @provider.id
    - @provider.cloud_accounts.each do |acct|
      %fieldset
        - disabled = 'disabled' unless has_account_modify?(@provider)
        - cloud_account_id = "cloud_accounts[#{acct.id}]"
        = text_field cloud_account_id, :label, :title => t('.account_name'), :value => acct.label, :disabled => disabled, :class => "grid_2 alpha"
        = text_field cloud_account_id, :username, :title => t('.access_key'), :value => acct.username, :disabled => disabled, :class => "grid_2"
        = password_field cloud_account_id, :password, :title => t('.secret_access_key'), :disabled => disabled, :class => "grid_2"
        = text_field "quota[#{acct.id}]", :maximum_running_instances, :title => t('.quota_instances'), :value => (acct.quota.maximum_running_instances.nil? ? "unlimited" : acct.quota.maximum_running_instances), :disabled => disabled, :id => "quota_instances#{acct.id}", :class => "grid_1"
        = text_field cloud_account_id, :account_number, :title => t('.account_number'), :value => acct.account_number, :disabled => disabled, :class => "grid_1"
        .grid_2
          = file_field cloud_account_id, :x509_cert_priv_file, :title => t('.account_private_cert'), :disabled => disabled
        .grid_2
          = file_field cloud_account_id, :x509_cert_pub_file, :title => t('.account_public_cert'), :disabled => disabled
        - remove_path = url_for :controller => 'cloud_accounts', :action => 'destroy', :id => acct.id if has_account_modify?(@provider) && acct.destroyable?
        .grid_1.omega
          %a.button{ :href => remove_path, :name => "remove_acc_#{acct.id}", :class => "tiny #{'disabled' unless remove_path}" }
            = t(:remove)
      .wrap
        .grid_2.alpha
          (
          %a{ :href => '' }<>
            = t('.test_account')
          )
        .grid_2.prefix_4
          (
          %a{ :href => '#', :onclick => "set_unlimited_quota(\"quota_instances#{acct.id}\");" }<>
            = t('.unlimited_quota')
          )

      = submit_tag t(:reset), :name => 'reset_form' unless @provider.cloud_accounts.empty?
      = submit_tag t(:save), :name => 'update_cloud_accounts' unless @provider.cloud_accounts.empty?
  - form_tag({:controller => 'cloud_accounts', :action => 'create'}, :multipart => true) do
    %fieldset.clearfix.nomargin
      = text_field :cloud_account, :label, :title => t('.account_name'), :class => "grid_2 alpha"
      = text_field :cloud_account, :username, :title => t('.access_key'), :class => "grid_2"
      = password_field :cloud_account, :password, :title => t('.secret_access_key'), :class => "grid_2"
      = text_field :quota, :maximum_running_instances, :title => t('.quota_instances'), :id => "new_quota_instances", :value => "unlimited", :class => "grid_1"
      = text_field :cloud_account, :account_number, :title => t('.account_number'), :class => "grid_1"
      .grid_2
        = file_field :cloud_account, :x509_cert_priv_file, :title => t('.account_private_cert')
      .grid_2
        = file_field :cloud_account, :x509_cert_pub_file, :title => t('.account_public_cert')
      = hidden_field :cloud_account, :provider_id, :value => @provider.id
      .grid_1.omega
        = submit_tag t(:add), :class => "tiny"
    .wrap
      .grid_2.alpha
        (
        %a{ :href => '' }<>
          = t('.test_account')
        )
      .grid_2.prefix_4
        (
        %a{ :href => '#', :onclick => 'set_unlimited_quota("new_quota_instances");' }<>
          = t('.unlimited_quota')
        )
    %section
      %p.requirement
        %span.required *
        \-
        = t('.required_field')
