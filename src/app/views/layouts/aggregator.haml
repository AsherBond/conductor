!!!
%html{html_attrs}
  %head
    %meta(http-equiv="content-type" content="text/html;charset=UTF-8")
    %title
      dCloud
      = yield :title
    = stylesheet_link_tag 'layout'
    = stylesheet_link_tag 'components'
    = stylesheet_link_tag 'dcloud'
    /[if IE]
      = stylesheet_link_tag 'ie'
    = stylesheet_link_tag '/javascripts/jquery-treeview/ovirt.treeview.css'
    = stylesheet_link_tag 'flexigrid/flexigrid.css'
    = stylesheet_link_tag 'facebox'
    = stylesheet_link_tag 'jquery.jgrowl.css'
    = stylesheet_link_tag 'ovirt-tree/tree'

    = javascript_include_tag "jquery-1.2.6.min.js"
    = javascript_include_tag "jquery-treeview/jquery.treeview.js"
    = javascript_include_tag "jquery-treeview/jquery.treeview.async.js"
    = javascript_include_tag "flexigrid.js"
    = javascript_include_tag "facebox.js"
    = javascript_include_tag "jquery.livequery.min.js"
    = javascript_include_tag "jquery.form.js"
    = javascript_include_tag "jquery.jgrowl.js"

    = javascript_include_tag "jquery.ui-1.5.2/ui/packed/ui.core.packed.js"
    = javascript_include_tag "jquery.ui-1.5.2/ui/packed/ui.tabs.packed.js"

    /ovirt-specific functions defined here
    = javascript_include_tag "ovirt.js"
    :javascript
      var $tabs, selected_tab;
      $(document).ready(function(){
         $.ajaxSetup({error: function(xhr) {$.jGrowl(xhr.status + ' ' + xhr.statusText);}});
            $('a[rel*=facebox]').livequery(function(){$(this).facebox();},function(){});
            $('.dialog_tab_nav a').livequery(function(){
                $(this).bind('click', function(){
                    $('.dialog_tab_nav li').removeClass('current');
                    $(this).parent().addClass('current');
                    $.ajax({
                        url: $(this).attr('href'),
                        type: 'GET',
                        data: {ajax:true},
                        dataType: 'html',
                        success: function(data) {
                          var wrapped_data = $(data).find('div').filter('[id=dialog-content-area]');
                          var my_parent = $(this).parent();
                          $('#dialog-content-area').html($(data));
                          $('#facebox').css('left', $(window).width() / 2 - ($('#facebox table').width() / 2));
                        },
                        error: function(xhr) {$.jGrowl(xhr.status + ' ' + xhr.statusText);}
                    });
                    return false;})},function(){});
                    $('ul.instance_action_list li:first-child').addClass('first');
      });
    = yield :scripts
  %body
    #header
      = render :partial => '/layouts/header'
    #side
      = render :partial => '/layouts/main_nav' unless @current_user.nil?
    #tabs-and-content-container
      #navigation-tabs(style="position:absolute; top:40px; left:250px;")
        = render :partial => '/layouts/navigation_tabs'
      #main
        #content_area
          = render :partial => '/layouts/notification'
          = (yield(:content) or yield) # content is set if we're using a sub template
