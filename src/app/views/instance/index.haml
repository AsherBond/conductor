- columns = [                                                     |
  {:name => '', :sortable => false},                              |
  {:name => 'STATUS', :sortable => false},                        |
  {:name => 'VM NAME', :sort_attr => 'name'},                     |
  {:name => 'TYPE', :sort_attr => 'hardware_profiles.name'},      |
  {:name => 'TEMPLATE', :sort_attr => 'templates.name'},          |
  {:name => 'IP ADDRESS', :sort_attr => 'public_ip_addresses'},   |
  {:name => 'PROVIDER', :sortable => false},                      |
  {:name => 'STARTED BY', :sort_attr => 'users.last_name'},       |
]                                                                 |

- form_tag(:action => 'instance_action') do
  .actionsidebar.grid_3
    %dl
      %dt Actions
      %dd
        %h5 Control Instances
        %ul
          %li.delete
            %span
            = submit_tag "Shutdown", :name => "shutdown", :class => "icon"

      %dd
        %h5 Manage Instances
        %ul
          %li.info
            %span
            = submit_tag "Instance Details", :name => "instance_details", :class => "icon"

  .grid_13
    %h2 Pool Status

    %h2 Instances by Pool
    - @pools.each do |pool|
      .grid_6.alpha.poolname
        %h4= pool.name
        = link_to image_tag("blnk.png", :border=>0) + "Launch Instance", {:controller => "instance", :action => "new", 'instance[pool_id]' => pool.id}, :class => "button iconbutton fr"

      .grid_4.poolfilter
        %input{:type => "radio", :id => "all_" + pool.id.to_s, :name => "filter_" + pool.id.to_s}
        %label{:for => "all_" + pool.id.to_s} Show All
        %input{:type => "radio", :id => "summary_" + pool.id.to_s, :name => "filter_" + pool.id.to_s}
        %label{:for => "summary_" + pool.id.to_s} Summary View
      .search.grid_3.omega
        %input{:type => "search", :placeholder => "Search Instance"}
        %button.action Search
      %table.gap
        = sortable_table_header(columns)
        %tbody
          - if not instances = @sorted_instances_by_pool[pool.id] or instances.empty?
            %tr
              %td{:colspan => 8} No Instances
          - else
            - instances.each do |inst|
              %tr
                %td= check_box_tag 'id[]', inst.id
                %td=inst.state
                %td= inst.name
                %td= inst.hardware_profile.name
                %td= inst.template.name
                %td= inst.public_ip_addresses
                %td= inst.cloud_account ? inst.cloud_account.provider.name : ''
                %td= "#{inst.owner.first_name} #{inst.owner.last_name}" # TODO, there is "started by" in comps pdf, but we don't save this info
